# Комментарии

Максим, привет!

На "ты" вполне комфортно, но я могу иногда забывать и переключаться на "вы" (рабочая привычка).
Хочу поблагодарить тебя за рекомендации по реализации в SQL. Я как раз искал оконную функцию, которая позволит разбить данные на бины без подзапросов.
После согласования логики, попробую переписать соответствующие запросы.
Параллельно я прохожу курс по SQL в Яндекс Практикуме, но еще не дошел до оконных функций, поэтому пока не было возможности нормально проработать.

По доработкам в проекте:

- Я внес изменения в datamart_ddl.sql.
- Хочу согласовать логику формирования tmp_rfm_recency.sql.
Если к users сделать left join таблицы orders, то увидим, что каждому user_id соответствует order_id со статусом 4 (Closed) или 5 (Cancelled).
Таким образом: для каждого user_id фиксируем последний по времени заказ со статусом 4 (Cancelled).
Если есть такие user_id, для которых не было заказов со статусом 4 (судя по всему таких клиентов ровно 12), то считаем, что этот клиент никогда не делал заказ и автоматически отправляем его в группу "1".


