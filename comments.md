# Комментарии

Максим, привет!

На "ты" вполне комфортно, но я могу иногда забывать и переключаться на "вы" (рабочая привычка).
Хочу поблагодарить тебя за рекомендации по реализации в SQL.
Параллельно я прохожу курс по SQL в Яндекс Практикуме, но еще не дошел до оконных функций, поэтому пока не было возможности нормально проработать.

По доработкам в проекте:

- Я внес изменения в datamart_ddl.sql. Считаю что ограничение вида `NOT NULL CHECK("recency" IN (1, 2, 3, 4, 5))` являются более корректными с точки зрения допустимых значений, чем `recency >= 1 AND recency <= 5`.
- Хочу обсудить логику формирования tmp_rfm_recency.sql. Ты пишешь, что я не учитываю клиентов, у которых нет закрытых заказов. 
Но перед тем как формировать витрину я постарался проанализировать логику появления данных в таблицах (насколько это возможно без документации) и пришел к выводу, что таких клиентов просто нет.
Например, если выполнить такой запрос:
`select
    u.id as user_id,
    order_id,
    status
from
    analysis.users u
    left join analysis.orders o on u.id=o.user_id`
- 
Увидим, что всем `user_id` соответствует `order_id`, при этом `status` 4 или 5.
