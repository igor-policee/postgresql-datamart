# Качество входных данных

| Таблица                                         | Объект                                                                                                                                     | Инструмент                  | Для чего используется                                                                                       |
|-------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------|-------------------------------------------------------------------------------------------------------------|
| `production.orderitems`                         | `ALTER TABLE production.orderitems ADD CONSTRAINT orderitems_pkey PRIMARY KEY (id);`                                                       | Первичный ключ              | Обеспечивает уникальность записей в таблице `production.orderitems`                                         |
| `production.orderitems`                         | `ALTER TABLE production.orderitems ADD CONSTRAINT orderitems_order_id_product_id_key UNIQUE (order_id, product_id)`                        | Проверка уникальности       | Обеспечивает уникальность комбинации полей (order_id, product_id), предотвращает ошибочное дублирование     |
| `production.orderitems`                         | `ALTER TABLE production.orderitems ADD CONSTRAINT orderitems_check CHECK (((discount >= (0)::numeric) AND (discount <= price)));`          | Ограничение вводимых данных | Обеспечивает проверку корректности данных, вводимых в поле `discount`                                       |
| `production.orderitems`                         | `ALTER TABLE production.orderitems ADD CONSTRAINT orderitems_price_check CHECK ((price >= (0)::numeric));`                                 | Ограничение вводимых данных | Обеспечивает проверку корректности данных, вводимых в поле `price`                                          |
| `production.orderitems`                         | `ALTER TABLE production.orderitems ADD CONSTRAINT orderitems_quantity_check CHECK ((quantity > 0));`                                       | Ограничение вводимых данных | Обеспечивает проверку корректности данных, вводимых в поле `quantity`                                       |
| `production.orderitems`                         | `ALTER TABLE production.orderitems ADD CONSTRAINT orderitems_order_id_fkey FOREIGN KEY (order_id) REFERENCES production.orders(order_id);` | Внешний ключ                | Обеспечивает согласованность полей `production.orderitems(order_id)` -> `production.orders(order_id)`       |
| `production.orderitems`                         | `ALTER TABLE production.orderitems ADD CONSTRAINT orderitems_product_id_fkey FOREIGN KEY (product_id) REFERENCES production.products(id);` | Внешний ключ                | Обеспечивает согласованность полей `production.orderitems(product_id)` -> `production.products(id)`         |
| `production.orders`                             | `ALTER TABLE production.orders ADD CONSTRAINT orders_pkey PRIMARY KEY (order_id);`                                                         | Первичный ключ              | Обеспечивает уникальность записей в таблице `production.orders`                                             |
| `production.orders`                             | `ALTER TABLE production.orders ADD CONSTRAINT orders_check CHECK ((cost = (payment + bonus_payment)));`                                    | Ограничение вводимых данных | Обеспечивает проверку корректности данных, вводимых в поле `cost`                                           |
| `production.orderstatuses`                      | `ALTER TABLE production.orderstatuses ADD CONSTRAINT orderstatuses_pkey PRIMARY KEY (id);`  | Первичный ключ                            | Обеспечивает уникальность записей в таблице `production.orderstatuses`                                      |
| `production.orderstatuslog`                     | `ALTER TABLE production.orderstatuslog ADD CONSTRAINT orderstatuslog_pkey PRIMARY KEY (id);`    | Первичный ключ                            | Обеспечивает уникальность записей в таблице `production.orderstatuslog`                                     |
| `production.orderstatuslog`                     | `ALTER TABLE production.orderstatuslog ADD CONSTRAINT orderstatuslog_order_id_status_id_key UNIQUE (order_id, status_id);`    | Проверка уникальности                            | Обеспечивает уникальность комбинации полей (order_id, status_id), предотвращает ошибочное дублирование      |
| `production.orderstatuslog`                     | `ALTER TABLE production.orderstatuslog ADD CONSTRAINT orderstatuslog_order_id_fkey FOREIGN KEY (order_id) REFERENCES production.orders(order_id);`   | Внешний ключ   | Обеспечивает согласованность полей `production.orderstatuslog(order_id)` -> `production.orders(order_id);`  |
| `production.orderstatuslog`                     | `ALTER TABLE production.orderstatuslog ADD CONSTRAINT orderstatuslog_status_id_fkey FOREIGN KEY (status_id) REFERENCES production.orderstatuses(id);`| Внешний ключ                                         | Обеспечивает согласованность полей `production.orderstatuslog(status_id)` -> `production.orderstatuses(id)` |
| `production.products`                           | `ALTER TABLE production.products ADD CONSTRAINT products_pkey PRIMARY KEY (id);`  | Первичный ключ                                        | Обеспечивает уникальность записей в таблице `production.products`                                           |
| `production.products`                           | `ALTER TABLE production.products ADD CONSTRAINT products_price_check CHECK ((price >= (0)::numeric));`  |   Ограничение вводимых данных                                      | Обеспечивает проверку корректности данных, вводимых в поле `price`                                          |
| `production.users`                                  | `ALTER TABLE production.users ADD CONSTRAINT users_pkey PRIMARY KEY (id);`     | Первичный ключ                                        | Обеспечивает проверку корректности данных, вводимых в поле `users`                                          |
| `все таблицы и все поля, кроме поля users.name` | `NOT NULL`                                                                                                                                          | Ограничение вводимых данных | Поля таблиц, на которые наложено это ограничение, не могут содержать значения типа NULL (пропуски)          |

На основе этой информации можно сделать вывод о достаточно высоком качестве данных в схеме `production`. 
Целостность данных можно доработать, создав дополнительные связи между таблицами `production.orderstatuses` и `production.orders` отношением «один ко многим».
